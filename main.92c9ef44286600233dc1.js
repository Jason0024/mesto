!function(){"use strict";const e=document.querySelector(".add-button"),t=document.querySelector(".profile__edit"),s=(document.querySelector(".element-grid"),document.querySelector(".popup__form_photo-type")),o=(Array.from(s.querySelectorAll(".popup__input")),s.querySelector(".popup__submit"),document.querySelector(".popup__input_type_title"),document.querySelector(".popup__input_type_src"),document.querySelector(".popup__form_profile-type"),document.querySelector(".popup_type_photo")),r=o.querySelector(".popup__form"),n=(o.querySelector(".popup__close"),document.querySelector(".popup_type_profile")),i=n.querySelector(".popup__form"),p=i.querySelector("#name"),l=i.querySelector("#job"),u=(n.querySelector(".popup__close"),document.querySelector(".profile__name"),document.querySelector(".profile__job"),document.querySelector(".popup_type_modal")),c=(u.querySelector(".popup__close"),u.querySelector(".popup__pic"),u.querySelector(".popup__caption"),document.querySelector(".elements")),a={inputSelector:".popup__input",submitButtonSelector:".popup__submit",inactiveButtonClass:"popup__submit_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"};class _{constructor(e,t){this._config=e,this._formElement=t,this._inactiveButtonClass=e.inactiveButtonClass,this._inputList=Array.from(this._formElement.querySelectorAll(this._config.inputSelector)),this._buttonElement=this._formElement.querySelector(this._config.submitButtonSelector)}_showInputError(e,t){const s=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.add(this._config.inputErrorClass),s.textContent=t,s.classList.add(this._config.errorClass)}_hideInputError(e){const t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(this._config.inputErrorClass),t.classList.remove(this._config.errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.setAttribute("disabled",!0),this._buttonElement.classList.add(this._inactiveButtonClass)):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled"))}_setEventListeners(){this.toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._setEventListeners()}}class d{constructor(e,t){let{data:s,handleCardClick:o}=e;this._name=s.name,this._link=s.link,this._cardSelector=t,this._handleCardClick=o}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".element-grid__item").cloneNode(!0)}_handleCardLike(){this._likeButton.classList.toggle("element-grid__like_active")}_handleCardDelete(){this._element.remove(),this._element=null}_handleOpenPopup(){this._handleCardClick(this._link,this._name)}_setEventListeners(){this._cardImage.addEventListener("click",(()=>{this._handleOpenPopup()})),this._likeButton.addEventListener("click",(()=>{this._handleCardLike()})),this._element.querySelector(".element-grid__delete").addEventListener("click",(()=>{this._handleCardDelete()}))}generateCard(){return this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".element-grid__pic"),this._likeButton=this._element.querySelector(".element-grid__like"),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._element.querySelector(".element-grid__title").textContent=this._name,this._setEventListeners(),this._element}}class h{constructor(e){this._popup=document.querySelector(e),this._closeButton=this._popup.querySelector(".popup__close"),this._escapeClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("popup_open"),document.addEventListener("keydown",this._escapeClose)}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._escapeClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._closeButton.addEventListener("click",(()=>{this.close()})),this._popup.addEventListener("mousedown",(e=>{e.target.classList.contains("popup")&&this.close()}))}}class m extends h{constructor(e){let{popupSelector:t,handleFormSubmit:s}=e;super(t),this._handleFormSubmit=s,this._popupForm=this._popup.querySelector(".popup__form"),this._inputList=this._popupForm.querySelectorAll(".popup__input")}_getInputValues(){return this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}close(){super.close(),this._popupForm.reset()}}const y=new class extends h{constructor(e){super(e),this._popupImage=this._popup.querySelector(".popup__pic"),this._popupName=this._popup.querySelector(".popup__caption")}open(e,t){this._popupImage.src=e,this._popupName.textContent=t,this._popupImage.alt=t,super.open()}}(".popup_type_modal");y.setEventListeners();const S=e=>new d({data:e,handleCardClick:(e,t)=>{y.open(e,t)}},".element-grid-template").generateCard(),v=new class{constructor(e){let{username:t,job:s}=e;this._username=document.querySelector(t),this._job=document.querySelector(s)}getUserInfo(){return{username:this._username.textContent,job:this._job.textContent}}setUserInfo(e){this._username.textContent=e.username,this._job.textContent=e.job}}({username:".profile__name",job:".profile__job"}),g=new m({popupSelector:".popup_type_profile",handleFormSubmit:e=>{v.setUserInfo(e),g.close()}});g.setEventListeners(),t.addEventListener("click",(()=>{const e=v.getUserInfo();!function(e){let{username:t,job:s}=e;p.value=t,l.value=s}({username:e.username,job:e.job}),g.open()}));const f=new m({popupSelector:".popup_type_photo",handleFormSubmit:e=>{E.addItem(S(e)),f.close()}});f.setEventListeners(),e.addEventListener("click",(()=>{b.toggleButtonState(),f.open()}));const E=new class{constructor(e,t){let{items:s,renderer:o}=e;this._renderedItems=s,this._renderer=o,this._container=t}renderItems(){this._renderedItems.forEach((e=>this._renderer(e)))}addItem(e){this._container.prepend(e)}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{E.addItem(S(e))}},c);E.renderItems(),new _(a,i).enableValidation();const b=new _(a,r);b.enableValidation()}();